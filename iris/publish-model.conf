subsystem               = TCS
component               = cmIRIS

publish {

  telemetry          = [
    {
      name              = imgCurAtmDispersion
      description       = """
       The TCS publishes the IRIS imager dispersion information at the current telescope location.
       The entire event is published atomically so that all published subcomponents are synchronized.
       """
      minRate           = 1
      maxRate           = 1
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = """
          The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC.

          *Discussion: The relative dispersion is reported about a reference dispersion at this wavelength. The expected ADC image shifts are also computed at the reference wavelength.*
          """
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = """
          Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of the FCRS<sub>IRIS-ROT</sub>.

           *Discussion: During LGS, NGS or seeing limited operations, the IRIS Imager ADC prism rotation angles are updated based on the Imager Atmospheric Dispersion data. The orientation angle is used to align the ADC axis of correction along the axis of dispersion.*
          """
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = """
          Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC.

          *Discussion: The numElem field represents the number of distinct wavelengths of dispersion information. The wavelength, weight and dispersion arrays each contain exactly numElem values. It is expected that the number of elements is large enough to provide the general shape of the dispersion over the required wavelength range. In a simplified mode of operation at which a specific setting of the ADC is desired for correction at a particular wavelength, numElem will be 1.*
          """
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = """
          An array of wavelengths. Each provided wavelength value must be unique. Range is TBC.

          *Discussion: The wavelength field represents the distinct wavelengths for which dispersion information is provided by the TCS. It is TBD whether the TCS will provide the same range of wavelengths for all ADC control or whether each ADC would only receive a restricted range of wavelengths based on the range of light that it would be correcting. The number of wavelength values provided must be exactly equal to the value of numElem. In a simplified mode of operation at which a specific setting of the ADC is desired for correction at a particular wavelength, only that wavelength will be specified.*
          """
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = """
          An array of weights. They must sum to 1.0.

          *Discussion: The weight field represents a weighting function to be applied to the dispersion curve; this weighting function from the TCS may include telescope throughput and source spectral energy distribution, although it is TBD whether all of these components are combined into this single function, or whether it is pieced together from several locations. This weight will not contain information local to the imager, such as the selected filter and detector quantum efficient. The number of weight values provided must be exactly equal to the value of numElem. Each weight must be non-negative and the sum of the weights is normalized to unity.*

          """
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = """
          An array of atmospheric dispersion values.

          *Discussion: The dispersion field is the calculated relative atmospheric dispersion at each wavelength after subtracting a reference dispersion at the reference wavelength. The dispersion is measured in arcseconds on the sky. The number of dispersion values provided must be exactly equal to the value of numElem. The IRIS CC will use the atmospheric dispersion values along with the weights and wavelengths to determine a power setting for the ADC.*
          """
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
      ]
    }

    {
      name              = imgNewAtmDispersion
      description       = """
      The TCS publishes a single new IRIS Imager Dispersion event each time a new target is to be acquired.
      Information is pertinent to the new target location.

      *Discussion: The ADC should adjust to the values indicated by tcs.cm.iris.imgNewAtmDispersion until a tcs.cm.iris.pointingStatus event is published with state set to Tracking, and the same counter value. At that point, it should switch back to tracking imgCurAtmDispersion.*

      *Discussion: See full descriptions of equivalent attributes in imgCurAtmDispersion*
      """
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = "The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC."
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = "Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = "Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC."
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = "An array of wavelengths. Each provided wavelength value must be unique. Range is TBC (0.6 to 0.8 if restricted to NGS path)."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = "An array of weights. They must sum to 1.0."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = "An array of atmospheric dispersion values."
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
        {
          name          = counter
          description   = "Unique TCS counter that is incremented (with rollover) each time a new target is acquired. TBD whether this is required."
          type          = long
        }
      ]
    }



    {
      name              = oiwfs1CurAtmDispersion
      description       = """
       The TCS publishes the IRIS OIWFS dispersion information (one for each probe) at the current telescope location.

      *Discussion: See full descriptions of equivalent attributes in imgCurAtmDispersion*
       """
      minRate           = 1
      maxRate           = 1
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = "The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC."
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = "Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of the FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = "Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC"
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = "An array of wavelengths. Each provided wavelength value must be unique. Range is TBC"
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = "An array of weights. They must sum to 1.0."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = "An array of atmospheric dispersion values."
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
      ]
    }

    {
      name              = oiwfs1NewAtmDispersion
      description       = """
      The TCS publishes single new IRIS OIWFS Dispersion events (one for each probe) each time a new target is to be acquired.
      Information is pertinent to the new target location.

      *Discussion: Each probe arm ADC should adjust to the values indicated by the correct tcs.cm.iris.oiwfsXNewAtmDispersion until the relevant tcs.cm.iris.oiwfsXpointingStatus event is published, with state set to Tracking, and the same counter value. At that point, it should switch back to tracking oiwfs1CurAtmDispersion. Note that each arm requires its own pointingStatus stream to enable subsets of the probes to acquire new stars while the remaining probes continue tracking.*

      *Discussion: See full descriptions of equivalent attributes in imgCurAtmDispersion*
      """
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = "The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC."
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = "Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = "Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC."
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = "An array of wavelengths. Each provided wavelength value must be unique. Range is TBC (0.6 to 0.8 if restricted to NGS path)."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = "An array of weights. They must sum to 1.0."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = "An array of atmospheric dispersion values."
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
        {
          name          = counter
          description   = "Unique TCS counter that is incremented (with rollover) each time a new target is acquired. TBD whether this is required."
          type          = long
        }
      ]
    }

    {
      name              = oiwfs2CurAtmDispersion
      description       = """
      The TCS publishes the IRIS OIWFS dispersion information (one for each probe) at the current telescope location.

      *Discussion: See full descriptions of equivalent attributes in imgCurAtmDispersion*
       """
      minRate           = 1
      maxRate           = 1
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = "The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC."
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = "Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of the FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = "Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC"
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = "An array of wavelengths. Each provided wavelength value must be unique. Range is TBC"
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = "An array of weights. They must sum to 1.0."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = "An array of atmospheric dispersion values."
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
      ]
    }

    {
      name              = oiwfs2NewAtmDispersion
      description       = """
      The TCS publishes single new IRIS OIWFS Dispersion events (one for each probe) each time a new target is to be acquired.
      Information is pertinent to the new target location.

      *Discussion: See full descriptions of equivalent attributes in imgCurAtmDispersion and oiwfs1NewAtmDispersion*
      """
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = "The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC."
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = "Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = "Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC."
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = "An array of wavelengths. Each provided wavelength value must be unique. Range is TBC (0.6 to 0.8 if restricted to NGS path)."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = "An array of weights. They must sum to 1.0."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = "An array of atmospheric dispersion values."
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
        {
          name          = counter
          description   = "Unique TCS counter that is incremented (with rollover) each time a new target is acquired. TBD whether this is required."
          type          = long
        }
      ]
    }


    {
      name              = oiwfs3CurAtmDispersion
      description       = """
       The TCS publishes the IRIS OIWFS dispersion information (one for each probe) at the current telescope location.

      *Discussion: See full descriptions of equivalent attributes in imgCurAtmDispersion*
       """
      minRate           = 1
      maxRate           = 1
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = "The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC."
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = "Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of the FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = "Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC"
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = "An array of wavelengths. Each provided wavelength value must be unique. Range is TBC"
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = "An array of weights. They must sum to 1.0."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = "An array of atmospheric dispersion values."
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
      ]
    }

    {
      name              = oiwfs3NewAtmDispersion
      description       = """
      The TCS publishes single new IRIS OIWFS Dispersion events (one for each probe) each time a new target is to be acquired.
      Information is pertinent to the new target location.

      *Discussion: See full descriptions of equivalent attributes in imgCurAtmDispersion and oiwfs1NewAtmDispersion*
      """
      archive           = true
      attributes        = [
        {
          name          = referenceWavelength
          description   = "The reference wavelength is the wavelength at which the computed dispersion is reported by the TCS as 0. Range is TBC."
          type          = double
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
        }
        {
          name          = orientation
          description   = "Orientation of the axis of dispersion due to atmospheric refraction defined in the XY plane of FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = -180
          maximum       = 180
          units         = degrees
        }
        {
          name          = numElem
          description   = "Number of entries (each) in the wavelengths, weights and dispersion elements. Range is TBC."
          type          = integer
          minimum       = 1
          maximum       = 30
        }
        {
          name          = wavelength
          description   = "An array of wavelengths. Each provided wavelength value must be unique. Range is TBC (0.6 to 0.8 if restricted to NGS path)."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.5
          maximum       = 3.0
          units         = microns
          items         = {
            type        = double
          }
        }
        {
          name          = weight
          description   = "An array of weights. They must sum to 1.0."
          type          = array
          minItems      = 1
          maxItems      = 30
          minimum       = 0.0
          maximum       = 1.0
          items         = {
            type        = double
          }
        }
        {
          name          = dispersion
          description   = "An array of atmospheric dispersion values."
          type          = array
          minItems      = 1
          maxItems      = 30
          units         = arcsec on sky
          items         = {
            type        = double
          }
        }
        {
          name          = counter
          description   = "Unique TCS counter that is incremented (with rollover) each time a new target is acquired. TBD whether this is required."
          type          = long
        }
      ]
    }

    {
      name              = oiwfs1pointingStatus
      description       = """
      The TCS publishes current pointing status events for each OIWFS probe arm independently, each time the state changes.

      *Discussion: See full descriptions of equivalent attributes in tcs.pk.pointingStatus.*
      """
      archive           = true
      attributes        = [
        {
          name          = state
          description   = "Current state of the pointing system"
          enum          = [Slewing,Tracking,InPosition]
        }
        {
          name          = counter
          description   = "Current target counter (incrementing with rollover)"
          type          = long
        }
      ]
    }

    {
      name              = oiwfs2pointingStatus
      description       = """
      The TCS publishes current pointing status events for each OIWFS probe arm independently, each time the state changes.

      *Discussion: See full descriptions of equivalent attributes in tcs.pk.pointingStatus.*
      """
      archive           = true
      attributes        = [
        {
          name          = state
          description   = "Current state of the pointing system"
          enum          = [Slewing,Tracking,InPosition]
        }
        {
          name          = counter
          description   = "Current target counter (incrementing with rollover)"
          type          = long
        }
      ]
    }

    {
      name              = oiwfs3pointingStatus
      description       = """
      The TCS publishes current pointing status events for each OIWFS probe arm independently, each time the state changes.

      *Discussion: See full descriptions of equivalent attributes in tcs.pk.pointingStatus.*
      """
      archive           = true
      attributes        = [
        {
          name          = state
          description   = "Current state of the pointing system"
          enum          = [Slewing,Tracking,InPosition]
        }
        {
          name          = counter
          description   = "Current target counter (incrementing with rollover)"
          type          = long
        }
      ]
    }

    {
      name              = instrumentRotatorAngle
      description       = """
      The TCS publishes the timestamped current IRIS instrument rotator angle.

      *Discussion: During LGS, NGS or seeing limited operations, the IRIS instrument rotator will rotate to derotate the field, which rotates as the telescope tracks a target across the sky (a combination of parallactic angle and pupil rotation). In addition, the rotator angle may include an offset if the observer has requested a particular PA.*
      """
      minRate           = 20
      maxRate           = 20
      archive           = true
      attributes        = [
        {
          name          = instrumentAngle
          description   = "Current rotator angle in the XY plane of the FCRS<sub>BP</sub>."
          type          = double
          minimum       = -135
          maximum       = 135
          units         = degrees
        }
        {
          name          = instrumentAngleTimestamp
          description   = "Associated timestamp (units TBD)"
          type          = double
          units         = mjd
        }
      ]
    }

    {
      name              = pupilRotation
      description       = """
      The TCS publishes the timestamped current pupil rotation angle.

      *Discussion: During LGS, NGS or seeing limited operations, the IRIS instrument rotator will correct for the combination of parallactic angle and pupil rotation, meaning that the pupil orientation will vary. The pupil mask rotators will need the current pupil rotation, likely after some linear transformation with constant coefficients, in order to keep a pupil mask aligned with the pupil image of the primary mirror.*
      """
      minRate           = 20
      maxRate           = 20
      archive           = true
      attributes        = [
        {
          name          = pupilRotation
          description   = "Current IRIS pupil rotation angle in the X,Y plane of the FCRS<sub>IRIS-ROT</sub>."
          type          = double
          minimum       = 90
          maximum       = 180
          units         = degrees
        }
        {
          name          = pupilRotationTimestamp
          description   = "Associated timestamp (units TBD)"
          type          = double
          units         = mjd
        }
      ]
    }

    {
      name              = oiwfsProbeDemands
      description       = """
      The TCS publishes the timestamped focal plane locations and velocities for each IRIS OIWFS at some TBD time in the future.

      *Discussion: During an observation, the TCS will provide the timestamped XY locations and velocities of the OIWFS sensors in the focal plane so that each OIWFS can accurately track its guide star.*
      """
      minRate           = 20
      maxRate           = 20
      archive           = true
      attributes        = [
        {
          name          = oiwfs1Pos
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm
          items = {
            type = double
          }
        }
        {
          name          = oiwfs2Pos
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm
          items = {
            type = double
          }
        }
        {
          name          = oiwfs3Pos
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm
          items = {
            type = double
          }
        }
        {
          name          = oiwfs1Vel
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm/s
          items = {
            type = double
          }
        }
        {
          name          = oiwfs2Vel
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm/s
          items = {
            type = double
          }
        }
        {
          name          = oiwfs3Vel
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm/s
          items = {
            type = double
          }
        }
        {
          name          = oiwfsPositionTimestamp
          description   = "Timestamp these are applicable (units TBD)"
          type          = double
          units         = mjd
        }
      ]
    }

    {
      name              = odgwPosDemands
      description       = """
      The TCS publishes the timestamped focal plane locations for each IRIS ODGW at some TBD time in the future.

      *During an observation, the TCS will provide the timestamped XY locations of the guide stars for ODGWs. Velocities are not required, as in the case of the OIWFS position streams, since window locations can be changed instantaneously.*
      """
      minRate           = 20
      maxRate           = 20
      archive           = true
      attributes        = [
        {
          name          = odgw1Pos
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm
          items = {
            type = double
          }
        }
        {
          name          = odgw2Pos
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm
          items = {
            type = double
          }
        }
        {
          name          = odgw3Pos
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm
          items = {
            type = double
          }
        }
        {
          name          = odgw4Pos
          description   = "2-element array holding x,y values in the FCRS<sub>IRIS-ROT</sub>."
          type          = array
          dimensions: [2]
          units = mm
          items = {
            type = double
          }
        }
        {
          name          = odgwPositionTimestamp
          description   = "Timestamp these are applicable (units TBD)"
          type          = double
          units         = mjd
        }
      ]
    }

  ]

}
